@model core.Modules.Problem.ProblemData
@{
    ViewBag.Title = "Solve Problem";
}

<h2>Solve Problem</h2>

<br />
<div>
    @Html.Raw(Model.Description)
</div>

<hr />

<textarea id="codeArea"></textarea>

<br />
<button id="submitButton">Submit</button>

@section scripts
{    
    @Scripts.Render("~/bundles/edit_area")
    <script type="text/javascript">
        $(function () {
            editAreaLoader.init({
                id: "codeArea",
                syntax: "python",
                start_highlight: true,
                allow_toggle: false,
                toolbar: "search, |, undo, redo, |, select_font,|, highlight, reset_highlight, word_wrap, |, help"
            });

            $('#submitButton').click(function () {
                $.ajax({
                    url: '@Url.Action("Solve")',
                    type: 'POST',
                    data: {
                        code: editAreaLoader.getValue("codeArea"),
                        id: @Model.Id,
                        record: @(ViewBag.Record ? "true" : "false" )
                    },
                    success: function (data) {
                        if (data.success) {
                            alert("Correct!");
                            window.location.href = '@Url.Action("Home", "Class", new { id = @Model.Class.Id })';
                        } else {
                            alert("Incorrect. Modify your code and try again.\r\nOutput: " + data.output);
                        }
                    }
                });
            });
        });
    </script>
}
